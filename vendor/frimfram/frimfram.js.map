{"version":3,"sources":["src/init.coffee","src/BaseClass.coffee","src/BaseView.coffee","src/Application.coffee","src/BaseCollection.coffee","src/BaseModel.coffee","src/ModalView.coffee","src/RootView.coffee","src/Router.coffee","src/network-error-callbacks.coffee","src/storage.coffee"],"names":[],"mappings":"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","file":"dist/frimfram.js","sourcesContent":["window.FrimFram = {\n  isProduction: -> window.location.href.indexOf('localhost') is -1\n}\n","class BaseClass\n  superMerge: (propertyName) ->\n    combined = {}\n    obj = @\n    while obj\n      value = obj?[propertyName]\n      _.defaults(combined, value)\n      obj = obj.__proto__ or Object.getPrototypeOf(obj)\n    combined\n\n  listenToShortcuts: ->\n    shortcuts = @superMerge('shortcuts')\n    if @scope\n      @stopListeningToShortcuts()\n    else\n      @scope = _.uniqueId('class-scope-')\n    for shortcut, func of shortcuts\n      func = @[func] if not _.isFunction(func)\n      continue unless func\n      key(shortcut, @scope, _.bind(func, @))\n\n  stopListeningToShortcuts: ->\n    key.deleteScope(@scope)\n\n  destroy: ->\n    @off() # clear Backbone Events\n    @stopListeningToShortcuts() # clear keymaster shortcuts\n    delete @[key] for key of @ # salt the earth\n    @destroyed = true\n    @destroy = _.noop\n\n_.extend(BaseClass.prototype, Backbone.Events)\n\nFrimFram.BaseClass = BaseClass","\nclass BaseView extends Backbone.View\n  \n  template: ''\n  shortcuts: {}\n  @globalContext = {\n    'moment': window.moment\n  }\n  @extendGlobalContext: (globals) -> @globalContext = _.extend(@globalContext, globals)\n\n\n  #- Setup\n\n  constructor: (options) ->\n    @events = @superMerge('events')\n    @subviews = {}\n    @listenToShortcuts()\n    super arguments...\n    \n    \n  #- Rendering functions\n    \n  render: ->\n    # reset subviews\n    view.destroy() for id, view of @subviews\n    @subviews = {}\n    @$el.html @getTemplateResult()\n    @onRender()\n\n  renderSelectors: (selectors...) ->\n    newTemplate = $(@getTemplateResult())\n    for selector in selectors\n      @$el.find(selector).replaceWith(newTemplate.find(selector))\n\n  getTemplateResult: ->\n    if _.isString(@template) then @template else @template(@getContext())\n    \n  initContext: (pickPredicate) ->\n    context = {}\n    context.pathname = document.location.pathname  # ex. '/play/level'\n    context = _.defaults context, BaseView.globalContext\n    context = _.extend context, _.pick(@, pickPredicate, @) if pickPredicate\n    context\n\n  getContext: -> @initContext()\n    \n    \n  #- Callbacks\n\n  onRender: _.noop # Good place to insert subviews\n\n  onInsert: _.noop # Called when view is inserted into the DOM\n\n\n  #- Shortcuts\n\n  listenToShortcuts: (recurse) ->\n    shortcuts = @superMerge('shortcuts')\n    if @scope\n      @stopListeningToShortcuts()\n    else\n      @scope = _.uniqueId('view-scope-')\n    for shortcut, func of @shortcuts\n      func = @[func] if not _.isFunction(func)\n      continue unless func\n      key(shortcut, @scope, _.bind(func, @))\n    if recurse\n      for viewID, view of @subviews\n        view.listenToShortcuts(true)\n\n  stopListeningToShortcuts: (recurse) ->\n    key.deleteScope(@scope)\n    if recurse\n      for viewID, view of @subviews\n        view.stopListeningToShortcuts(true)\n\n\n  #- Subviews\n\n  insertSubview: (view, elToReplace=null) ->\n    # used to insert views with ids\n    key = @makeSubviewKey(view)\n    oldSubview = @subviews[key]\n    elToReplace ?= @$el.find('#'+view.id)\n    if not elToReplace.length\n      throw new Error('Error inserting subview: do not have element for it to replace.')\n    elToReplace.after(view.el).remove()\n    @registerSubview(view, key)\n    view.render()\n    view.onInsert()\n    oldSubview?.destroy()\n    view\n\n  registerSubview: (view, key) ->\n    # used to register views which are custom inserted into the view,\n    # like views where you add multiple instances of them\n    key ?= @makeSubviewKey(view)\n    @subviews[key] = view\n    view\n\n  makeSubviewKey: (view) ->\n    key = view.id or (_.uniqueId(view.constructor.name))\n    key = _.underscored(key)  # handy for autocomplete in dev console\n    key\n\n  removeSubview: (view) ->\n    view.$el.empty()\n    key = _.findKey @subviews, (v) -> v is view \n    delete @subviews[key] if key\n    view.destroy()\n\n      \n  #- Utilities\n\n  getQueryParam: (param) ->\n    BaseView.getQueryParam(param)\n    \n  @getQueryParam: (param) ->\n    query = @getQueryString()\n    pairs = (pair.split('=') for pair in query.split '&')\n    for pair in pairs when pair[0] is param\n      return {'true': true, 'false': false}[pair[1]] ? decodeURIComponent(pair[1])\n    return\n    \n  @getQueryString: -> document.location.search.substring 1\n\n  \n  #- Teardown\n\n  destroy: ->\n    @remove()\n    @stopListeningToShortcuts()\n    view.destroy() for view in _.values(@subviews)\n    delete @[key] for key, value of @\n    @destroyed = true\n    @destroy = _.noop\n\n_.defaults(BaseView.prototype, FrimFram.BaseClass.prototype)\n    \nFrimFram.BaseView = BaseView\n","class Application extends FrimFram.BaseClass\n  @extend: Backbone.Model.extend\n  \n  #- Initialization\n  \n  constructor: ->\n    @watchForErrors()\n    _.mixin(s.exports())\n    $(document).bind 'keydown', @preventBackspace\n    @handleNormalUrls()\n    @initialize()\n    \n  initialize: _.noop\n  \n  start: ->\n    Backbone.history.start({ pushState: true })\n\n    \n  #- Error reporting\n    \n  watchForErrors: ->\n    window.onerror = (msg, url, line, col, error) ->\n      return if $('body').find('.runtime-error-alert').length\n      alert = $(FrimFram.runtimeErrorTemplate({errorMessage: msg}))\n      $('body').append(alert)\n      alert.addClass('in')\n      alert.alert()\n      close = -> alert.alert('close')\n      \n      \n  #- Backspace navigation stopping\n  \n  # Prevent Ctrl/Cmd + [ / ], P, S\n  @ctrlDefaultPrevented: [219, 221, 80, 83]\n  preventBackspace: (event) =>\n    if event.keyCode is 8 and not @elementAcceptsKeystrokes(event.srcElement or event.target)\n      event.preventDefault()\n    else if (key.ctrl or key.command) and not key.alt and event.keyCode in Application.ctrlDefaultPrevented\n      event.preventDefault()\n\n  elementAcceptsKeystrokes: (el) ->\n    # http://stackoverflow.com/questions/1495219/how-can-i-prevent-the-backspace-key-from-navigating-back\n    el ?= document.activeElement\n    tag = el.tagName.toLowerCase()\n    type = el.type?.toLowerCase()\n    textInputTypes = ['text', 'password', 'file', 'number', 'search', 'url', 'tel', 'email', 'date', 'month', 'week', 'time', 'datetimelocal']\n    # not radio, checkbox, range, or color\n    return (tag is 'textarea' or (tag is 'input' and type in textInputTypes) or el.contentEditable in ['', 'true']) and not (el.readOnly or el.disabled)\n\n    \n  #- Single-page web app URLs w/out hashbang\n    \n  handleNormalUrls: ->\n    # http://artsy.github.com/blog/2012/06/25/replacing-hashbang-routes-with-pushstate/\n    $(document).on 'click', \"a[href^='/']\", (event) ->\n      href = $(event.currentTarget).attr('href')\n      passThrough = href.indexOf('sign_out') >= 0\n      if !passThrough && !event.altKey && !event.ctrlKey && !event.metaKey && !event.shiftKey\n        event.preventDefault()\n        url = href.replace(/^\\//,'').replace('\\#\\!\\/','')\n        app.router.navigate url, { trigger: true }\n        return false\n    \n    \nFrimFram.Application = Application","class BaseCollection extends Backbone.Collection\n  \n  dataState: 'standby' # or 'fetching'\n\n  initialize: (models, options) ->\n    super(models, options)\n    if options?.defaultFetchData\n      @defaultFetchData = options.defaultFetchData\n\n  fetch: (options) ->\n    @dataState = 'fetching'\n    options ?= {}\n    givenSuccess = options.success\n    givenError = options.error\n    options.success = =>\n      @dataState = 'standby'\n      givenSuccess?(arguments...)\n    options.error = =>\n      @dataState = 'standby'\n      givenError?(arguments...)\n    if @defaultFetchData\n      options.data ?= {}\n      _.defaults(options.data, @defaultFetchData)\n    return super(options)\n    \n  # At some later point, create save, patch, destroy methods?\n\n    \nFrimFram.BaseCollection = BaseCollection ","class BaseModel extends Backbone.Model\n\n  dataState: 'standby' # or 'fetching', 'saving'\n  \n  initialize: (attributes, options) ->\n    super(attributes, options)\n    @on 'sync', @onLoadedOrAdded, @\n    @on 'add', @onLoadedOrAdded, @\n    @on 'error', @onError, @\n    \n  onError: -> @dataState = 'standby'\n  onLoadedOrAdded: -> @dataState = 'standby'\n\n  schema: ->\n    s = @constructor.schema\n    if _.isString s then tv4.getSchema(s) else s\n\n  onInvalid: ->\n    console.debug \"Validation failed for #{@constructor.className or @}: '#{@get('name') or @}'.\"\n    for error in @validationError\n      console.debug \"\\t\", error.dataPath, ':', error.message\n\n  get: (attr) ->\n    if _(attr).contains('.')\n      parts = attr.split('.')\n      value = @attributes\n      for subKey in parts\n        subKey = parseInt(subKey) if _.isArray(value)\n        value = value?[subKey]\n      return value\n    else\n      return Backbone.Model.prototype.get.apply(@, [attr])\n\n  set: (attributes, options) ->\n    if (@dataState isnt 'standby') and not (options.xhr or options.headers)\n      throw new Error('Cannot set while fetching or saving.')\n\n    if _.isString(attributes)\n      a = {}\n      a[attributes] = options\n      attributes = a\n      options = {}\n\n    for key of attributes\n      continue unless _(key).contains('.')\n      parts = key.split('.')\n      slim = _.pick(@attributes, parts[0])\n      clone = _.merge({}, slim)\n      value = clone\n      for subKey in parts\n        parent = value\n        subKey = parseInt(subKey) if _.isArray(value)\n        value = value?[subKey]\n      if parent\n        parent[subKey] = attributes[key]\n        @set(clone)\n      delete attributes[key]\n\n    Backbone.Model.prototype.set.apply(@, [attributes, options])\n\n    return super(attributes, options)\n\n  getValidationErrors: ->\n    errors = tv4?.validateMultiple(@attributes, @constructor.schema or {}).errors\n    return errors if errors?.length\n\n  validate: -> @getValidationErrors()\n\n  save: (attrs, options) ->\n    result = super(attrs, options)\n    @dataState = 'saving'\n    return result\n\n  fetch: (options) ->\n    @dataState = 'fetching'\n    return super(options)\n\n\n\nFrimFram.BaseModel = BaseModel","class ModalView extends FrimFram.BaseView\n  @visibleModal: null\n\n  className: 'modal fade'\n  destroyOnHidden: true\n\n  onRender: ->\n    super()\n\n    # proxy Bootstrap events to Backbone View events\n    modal = @\n    @$el.on 'show.bs.modal', -> modal.trigger 'show'\n    @$el.on 'shown.bs.modal', ->\n      modal.onInsert()\n      modal.trigger 'shown'\n    @$el.on 'hide.bs.modal', -> modal.trigger 'hide'\n    @$el.on 'hidden.bs.modal', -> modal.onHidden()\n    @$el.on 'loaded.bs.modal', -> modal.trigger 'loaded'\n    \n  hide: (fast) ->\n    @$el.removeClass('fade') if fast\n    @$el.modal('hide')\n\n  show: (fast) ->\n    ModalView.visibleModal?.hide(true)\n    @render()\n    @$el.removeClass('fade') if fast\n    $('body').append @$el\n    @$el.modal('show')\n    ModalView.visibleModal = @\n\n  toggle: -> @$el.modal('toggle')\n\n  onHidden: ->\n    ModalView.visibleModal = null if ModalView.visibleModal is @\n    @trigger 'hidden'\n    @destroy() if @destroyOnHidden\n\nFrimFram.ModalView = ModalView","class RootView extends FrimFram.BaseView\n\n  onInsert: ->\n    super(arguments...)\n    title = _.result(@, 'title') or @constructor.name\n    $('title').text(title)\n\n  title: _.noop\n\nFrimFram.RootView = RootView","class Router extends Backbone.Router\n  @go = (path) -> -> @routeDirectly path, arguments\n\n  #- Routing functions\n\n  routeToServer: ->\n    window.location.reload(true)\n\n  routeDirectly: (path, args) ->\n    return document.location.reload() if @currentView?.reloadOnClose\n    \n    path = \"views/#{path}\"\n\n    try\n      ViewClass = require(path)\n    catch error\n      if error.toString().search('Cannot find module \"' + path + '\" from') is -1\n        throw error\n\n    ViewClass ?= NotFoundView\n    view = new ViewClass({params: args})\n    @openView(view)\n\n  #- Opening, closing views\n    \n  openView: (view) ->\n    @closeCurrentView()\n    view.render()\n    $('body').empty().append(view.el)\n    @currentView = view\n    view.onInsert()\n    \n  closeCurrentView: -> @currentView?.destroy()\n\nFrimFram.Router = Router","\n#- Error handling\nFrimFram.onModelError = (model, jqxhr) -> FrimFram.onAjaxError(jqxhr)\n\nFrimFram.onAjaxError = (jqxhr) ->\n  r = jqxhr.responseJSON\n  console.log r or jqxhr.responseText\n  r ?= {}\n  s = \"Response error #{r.error} (#{r.statusCode}): #{r.message}\"\n  alert = $(FrimFram.runtimeErrorTemplate({errorMessage: s}))\n  $('body').append(alert)\n  alert.addClass('in')\n  alert.alert()\n  close = -> alert.alert('close')\n\nFrimFram.runtimeErrorTemplate = _.template(\"\"\"\n  <div class=\"runtime-error-alert alert alert-danger fade\">\n    <button class=\"close\" type=\"button\" data-dismiss=\"alert\">\n      <span aria-hidden=\"true\">&times;</span>\n    </button>\n    <strong class=\"spr\">Runtime Error:</strong>\n    <span><%= errorMessage %></span>\n    <br/>\n    <span class=\"pull-right text-muted\">See console for more info.</span>\n  </div>\n\"\"\")\n\n","FrimFram.storage = {\n  prefix: '-storage-'\n  \n  load: (key) ->\n    s = localStorage.getItem(@prefix+key)\n    unless s\n      return null\n    try\n      value = JSON.parse(s)\n      return value\n    catch SyntaxError\n      console.warn('error loading from storage', key)\n      return null\n  \n  save: (key, value) ->\n    localStorage.setItem(@prefix+key, JSON.stringify(value))\n  \n  remove: (key) ->\n    localStorage.removeItem(@prefix+key)\n    \n  clear: ->\n    for key of localStorage\n      if key.indexOf(@prefix) is 0\n        localStorage.removeItem(key)\n}\n"]}